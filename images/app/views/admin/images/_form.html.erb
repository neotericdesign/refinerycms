<%= form_for [:admin, @image], :url => @url_override || @url, :html => {:multipart => true, :id => 'image_form'} do |f| %>

  <%= render :partial => "/shared/admin/error_messages",
             :locals => {
               :object => @image,
               :include_object_name => false
             } %>

  <div id="image_file" class='field'>
    <h2>File</h2>
    <% if action_name =~ /(edit)|(update)/ %>
      <div class="field">
        <p>
          <%= radio_button nil, :keep, nil, :name => 'which_image', :checked => true %>
          <label for="_keep"><%= t('.use_current_image') %></label><br>
          <span id="current_image">
            <%= image_fu @image, '225x255>', :class => "brown_border" %>
          </span>
        </p>
      </div>
      <div class="field">
        <p>
          <%= radio_button nil, :replace, nil, :name => 'which_image', :checked => false %>
          <label for="_replace"><%= t('.replace_image') %></label><br>
          <%= f.file_field :image %>
          <p><span><%= t('.maximum_image_size', :megabytes => Image::MAX_SIZE_IN_MB) %></span></p>
        </p>
      </div>
    <% else %>
      <% # we must only hint at multiple when it's a new record otherwise update fails. %>
      <%= f.file_field :image, :multiple => true %>
    <% end %>
  </div>
  
  <div class='field'>
    <%= f.label :name, "Image Name <span>(Optional)</span>".html_safe %>
    <%= f.text_field :name, :class => 'larger' %>
  </div>
  
  <div class='field'>
    <%= f.label :caption, "Caption <span>(Optional)</span>".html_safe %>
    <%= f.text_field :caption, :class => 'larger' %>
  </div>
  
  <div class='field'>
    <%= f.label :tag_list, "Tags <span>(Optional)</span>".html_safe %>
    <%= f.text_field :tag_list, :class => 'larger' %>
  </div>
  
  <div class='field'>
    <%= f.label :alt_attribute, "Alt Attribute <span>(Optional)</span>".html_safe %>
    <%= f.text_field :alt_attribute, :class => 'larger' %>
  </div>

  <div class='field'>
    <%= f.label :title_attribute, "Title Attribute <span>(Optional)</span>".html_safe %>
    <%= f.text_field :title_attribute, :class => 'larger' %>
  </div>
  
    <div class='field'>
    <%= f.label :description, "Description <span>(Optional, for internal search only)</span>".html_safe %>
    <%= f.text_area :description, :size => '50x3' %>
  </div>
  
  <input type='hidden' name='wymeditor' value='<%= params[:wymeditor] %>'>

  <%= render :partial => "/shared/admin/form_actions",
             :locals => {
               :f => f,
               :continue_editing => false,
               :hide_cancel => (@app_dialog or action_name == "insert" or from_dialog?),
               :delete_title => t('delete', :scope => 'admin.images'),
               :delete_confirmation => t('message', :scope => 'shared.admin.delete', :title => @image.image_name)
             } -%>

  <% if @app_dialog %>
    <input type='hidden' name='app_dialog' value='<%= @app_dialog %>' />
    <input type='hidden' name='field' value='<%= @field %>' />
    <input type='hidden' name='update_image' value='<%= @update_image %>' />
    <input type='hidden' name='thumbnail' value='<%= @thumbnail %>' />
    <input type='hidden' name='callback' value='<%= @callback %>' />
    <input type='hidden' name='conditions' value='<%= @conditions %>' />
  <% end %>
<% end %>
<% content_for :stylesheets, render('images.css') %>
<% content_for :javascripts, render('images.js') %>
<%= render 'shared/admin/autocomplete', :dom_id => '#image_tag_list', :url => tags_admin_images_url %>
